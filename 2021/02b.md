---
presentation:
  transition: "none"
  enableSpeakerNotes: true
  margin: 0
---

@import "../common/css/font-awesome-4.7.0/css/font-awesome.css"
@import "../common/css/zhangt-solarized.css"
@import "css/GNN.css"

<!-- slide data-notes="" -->

GNN-HEADER 特征变换 随机投影

Johnson–Lindenstrauss 定理：给定$\epsilon \in (0,1)$和正整数$m$，设整数$d$满足

$$
\begin{align*}
    d \ge 4 (\epsilon^2/2 - \epsilon^3/3)^{-1} \ln m
\end{align*}
$$

则对$\Rbb^D$中的任意$m$个点组成的集合$\Scal$，存在可在随机多项式时间内求出的线性映射$f: \Rbb^D \mapsto \Rbb^d$使得对任意$\uv, \vv \in \Scal$有

$$
\begin{align*}
    (1 - \epsilon) \| \uv -\vv \|^2 \le \| f(\uv) - f(\vv) \|^2 \le (1 + \epsilon) \| \uv - \vv \|^2
\end{align*}
$$

简言之 JL 定理表明高维空间中的点集映射到低维空间可相对保持距离

<br>

投影矩阵通常采用 (随机矩阵 → 正交矩阵)

- 高斯随机矩阵：每个元素从高斯随机变量$\Ncal(0,1/d)$中采样
- 稀疏随机矩阵：每个元素以$1/2s$的概率取$\pm \sqrt{s/d}$，以$1-1/s$的概率取$0$

GNN-FOOTER 图神经网络导论 机器学习 tengzhang@hust.edu.cn

<!-- slide vertical=true data-notes="" -->

GNN-HEADER 特征变换 随机投影

```python {.line-numbers}
import numpy as np
from scipy.spatial import distance

X = np.random.rand(100, 10000)
D1 = distance.cdist(X, X, 'euclidean') # 原样本的成对距离矩阵

transformer = random_projection.GaussianRandomProjection() # 高斯随机矩阵
XX = transformer.fit_transform(X)
D2 = distance.cdist(XX, XX, 'euclidean') # 投影后样本的成对距离矩阵

XX.shape
(100, 3947)

np.linalg.norm(D1 - D2, ord='fro') # 两个成对距离矩阵差的F范数
46.74573519884732

transformer = random_projection.GaussianRandomProjection() # 稀疏随机矩阵
XX = transformer.fit_transform(X)
D2 = distance.cdist(XX, XX, 'euclidean') # 投影后样本的成对距离矩阵

np.linalg.norm(D1 - D2, ord='fro') # 两个成对距离矩阵差的F范数
43.819210159457796
```

GNN-FOOTER 图神经网络导论 机器学习 tengzhang@hust.edu.cn
