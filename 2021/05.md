---
presentation:
  transition: "none"
  enableSpeakerNotes: true
  margin: 0
---

@import "../common/css/font-awesome-4.7.0/css/font-awesome.css"
@import "../common/css/zhangt-solarized.css"
@import "css/GNN.css"

<!-- slide data-notes="" -->
<div class="header"><img class="hust"></div>

<div class="bottom15"></div>

# 图神经网络导论

<hr class="width50">

## 卷积神经网络

<div class="bottom5"></div>

### 计算机科学与技术学院 &nbsp; &nbsp; 张腾

<br>

#### tengzhang@hust.edu.cn

<!-- slide vertical=true data-notes="" -->

GNN-HEADER 大纲

@import "../dot/outline-cnn.dot"

GNN-FOOTER 图神经网络导论 卷积神经网络 tengzhang@hust.edu.cn

<!-- slide data-notes="" -->

GNN-HEADER 局部连接

设样本是 100 × 100 的图片，对全连接网络，第一个隐藏层每个神经元都对应 10000 个权重参数，随着神经元数量增多，参数规模急剧增加

- 训练效率非常低
- 很容易出现过拟合

@import "../dot/dense-vs-cnn.dot" {.center}

局部连接：限制神经元的输入权重个数，降低参数规模和模型复杂度

GNN-FOOTER 图神经网络导论 卷积神经网络 tengzhang@hust.edu.cn

<!-- slide vertical=true data-notes="" -->

GNN-HEADER 权重共享

<img src="../tikz/convolution1d.svg" class="center width75 top4 bottom4">

<div class="center">

$$
\begin{align*}
    a_1 & = x_1 \times w_1 + x_2 \times w_2 + x_3 \times w_3 \\
    a_2 & = x_2 \times w_1 + x_3 \times w_2 + x_4 \times w_3 \\
    a_3 & = x_3 \times w_1 + x_4 \times w_2 + x_5 \times w_3 \\
    a_4 & = x_4 \times w_1 + x_5 \times w_2 + x_6 \times w_3
\end{align*}
$$

</div>

<div class="bottom4"></div>

### 卷积神经网络：局部连接，权值共享

GNN-FOOTER 图神经网络导论 卷积神经网络 tengzhang@hust.edu.cn

<!-- slide data-notes="这页是在讲为啥叫卷积" -->

GNN-HEADER 一维卷积

$$
\begin{align*}
    (f \otimes g) [n] = \sum_{m = -\infty}^\infty f[m] \cdot g[n-m]
\end{align*}
$$

<img src="../tikz/convolution1d.svg" class="center width75 top3 bottom4">

取$f[i] = x_i$，$g[-2] = w_3$，$g[-1] = w_2$，$g[0] = w_1$，其余为零，则有

$$
\begin{align*}
    a_n = x_n w_1 + x_{n+1} w_2 + x_{n+2} w_3 = \sum_{m=n}^{n+2} f[m] \cdot g[n-m] = (f \otimes g) [n]
\end{align*}
$$

GNN-FOOTER 图神经网络导论 卷积神经网络 tengzhang@hust.edu.cn

<!-- slide vertical=true data-notes="" -->

GNN-HEADER 二维卷积

针对输入是矩阵的情形

<img src="../tikz/convolution2d.svg" class="center width75 top3 bottom4">

参与卷积的深色区域称为对应输出神经元的感受野 (receptive field)

GNN-FOOTER 图神经网络导论 卷积神经网络 tengzhang@hust.edu.cn

<!-- slide data-notes="" -->

GNN-HEADER 图像滤波

平滑去噪

<div class="multi_column top6 left6" style="height:280px">
    <img src="../common/img/tj.jpg" class="height100" >
    <div style="display:flex;align-items:center;height:100%">
        <p class="left2">
            $\otimes ~ \begin{bmatrix}
                \frac{1}{9} & \frac{1}{9} & \frac{1}{9} \\ \frac{1}{9} & \frac{1}{9} & \frac{1}{9} \\ \frac{1}{9} & \frac{1}{9} & \frac{1}{9}
            \end{bmatrix} ~ =$ 
        </p>
    </div>
    <img src="../common/img/tj1.jpg" class="left-2 height100">
</div>

GNN-FOOTER 图神经网络导论 卷积神经网络 tengzhang@hust.edu.cn

<!-- slide data-notes="" -->

GNN-HEADER 图像卷积

边缘提取

<div class="multi_column top6 left6" style="height:280px">
    <img src="../common/img/tj.jpg" class="height100" >
    <div style="display:flex;align-items:center;height:100%">
        <p class="left2">
            $\otimes ~ \begin{bmatrix}
                0 & 1 & 1 \\ -1 & 0 & 1 \\ -1 & -1 & 0
            \end{bmatrix} ~ = $ 
        </p>
    </div>
    <img src="../common/img/tj3.jpg" class="left-2 height100">
</div>

GNN-FOOTER 图神经网络导论 卷积神经网络 tengzhang@hust.edu.cn

